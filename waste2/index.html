<!DOCTYPE html>
<html>
<head>
  <title>ESP32-CAM Trigger</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDWduFyCRQTbs1_EdJOk-RRrjkqyIPcKYg",
      authDomain: "wastemangemen.firebaseapp.com",
      databaseURL: "https://wastemangemen-default-rtdb.firebaseio.com",
      projectId: "wastemangemen",
      storageBucket: "wastemangemen.appspot.com",
      messagingSenderId: "899523229793",
      appId: "1:899523229793:web:a09b077d1f0bb8c85d9220"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const photoRef = ref(db, 'latestPhoto');

    function triggerPhoto() {
      // Replace with your ESP32 local IP
      fetch('http://192.168.1.100/capture')
        .then(response => alert("Trigger sent!"))
        .catch(err => alert("Error: " + err));
    }

    onValue(photoRef, (snapshot) => {
      const url = snapshot.val();
      if(url) {
        document.getElementById('photo').src = url;
      }
    });
  </script>
</head>
<body>
  <h1>ESP32-CAM Trigger Photo</h1>
  <button onclick="triggerPhoto()">Capture Photo</button>
  <h2>Latest Photo:</h2>
  <img id="photo" width="400" alt="Latest Photo">
</body>
</html>
